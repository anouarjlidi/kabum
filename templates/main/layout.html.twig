{#
Copyright 2019 Douglas Silva (0x9fd287d56ec107ac)

This file is part of KaBuM!.

KaBuM! is free software: you can redistribute it and/or modify
it under the terms of the GNU Affero General Public License as published by
the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU Affero General Public License for more details.

You should have received a copy of the GNU Affero General Public License
along with KaBuM!.  If not, see <https://www.gnu.org/licenses/>.
#}

{% extends 'base.html.twig' %}

{% block stylesheets %}
  {{ parent() }}
  {{ encore_entry_link_tags('main') }}
{% endblock %}

{% block body %}
  <div class="d-flex flex-column flex-md-row">
    <div id="sidebar">
      <div class="d-flex justify-content-md-center justify-content-between pb-1">
        <a href="{{ path('main_page') }}" aria-label="{{ 'go_home_page'|trans }}">
          <img src="{{ asset('images/kabum.png') }}" id="header-brand" alt="{{ 'logotype'|trans }}">
        </a>
        <button class="navbar-toggler d-md-none" type="button" data-toggle="collapse" data-target="#sidebar-content" aria-expanded="false" aria-controls="sidebar-content" aria-label="{{ 'toggle_main_menu'|trans }}">
          <i class="fas fa-bars" aria-hidden="true"></i>
        </button>
      </div>
      <div id="sidebar-content" class="collapse py-3">
        <div class="py-2">
          <div class="d-flex justify-content-center">
            <a class="nav-link text-kabum-orange" role="button" href="#" aria-label="{{ 'shopping_cart'|trans }}">
              <i class="shopping-cart-icon" aria-hidden="true"></i>
            </a>
            {% if app.user %}
              <a class="nav-link text-kabum-orange" role="button" href="#" aria-label="{{ 'wishlist'|trans }}">
                <i class="wishlist-icon" aria-hidden="true"></i>
              </a>
            {% endif %}
            {% if app.user %}
              <div class="dropdown">
                <a class="nav-link dropdown-toggle text-kabum-orange" href="#" role="button" id="user-menu" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" aria-label="{{ 'user_menu'|trans }}">
                  <i class="user-icon" aria-hidden="true"></i>
                </a>

                <div class="dropdown-menu dropdown-menu-right" aria-labelledby="user-menu">
                  {% if is_granted('ROLE_ADMIN') %}
                    <a class="dropdown-item" href="{{ path('admin_new_product') }}">{{ 'control_panel'|trans }}</a>
                  {% endif %}
                  <a class="dropdown-item" href="{{ path('user_account') }}">{{ 'your_account'|trans }}</a>
                  <div class="dropdown-divider"></div>
                  <a class="dropdown-item" href="{{ path('app_logout') }}">{{ 'sign_out'|trans }}</a>
                </div>
              </div>
            {% else %}
              <a class="nav-link text-kabum-orange" href="{{ path('app_login') }}" aria-label="{{ 'sign_in_kabum_account'|trans }}">
                <i class="sign-in-icon" aria-hidden="true"></i>
              </a>
            {% endif %}
          </div>
        </div>
        <div class="instant-search-wrapper mb-4">
          <form action="{{ path('search') }}" role="search">
            <label for="instant-search-input" class="sr-only">{{ 'search'|trans }}</label>
            <input id="instant-search-input" type="search" name="query"
              class="instant-search-input form-control" placeholder="{{ 'search'|trans }}"
              autocomplete="off" role="combobox" aria-autocomplete="list"
              aria-describedby="instant-search-help" aria-expanded="false"
              aria-controls="instant-search-box instant-search-status"/>
            <span id="instant-search-help" class="sr-only">
              {{ 'results_appear_as_you_type'|trans }}
            </span>
            <span id="instant-search-status" class="instant-search-status sr-only" role="status"></span>
          </form>
          <div id="instant-search-box" role="listbox" class="instant-search-box">
            <div class="instant-search-result list-group"></div>
          </div>
        </div>
        <nav class="nav flex-column flex-nowrap">
          {{ render(controller('App\\Controller\\MainController::categoryList')) }}
        </nav>
      </div>
    </div>
    <div class="d-flex flex-column w-100">
      {% block main %}{% endblock %}
    </div>
  </div>
{% endblock %}

{% block javascripts %}
  {{ parent() }}
  {{ encore_entry_script_tags('main') }}
{% endblock %}
